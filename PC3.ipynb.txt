{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 203,
   "id": "17645492-6fa0-4c81-b0a9-7cd13a464167",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Datos de Level 1:\n",
      "   Unnamed: 0 Table 1. Human Development Index and its components   \\\n",
      "0        NaN                                                NaN     \n",
      "1        NaN                                                NaN     \n",
      "2        NaN                                                NaN     \n",
      "3   HDI rank                                            Country     \n",
      "4        NaN                                                NaN     \n",
      "\n",
      "                       Unnamed: 2  Unnamed: 3                Unnamed: 4  \\\n",
      "0                             NaN         NaN                       NaN   \n",
      "1                             NaN         NaN                      SDG3   \n",
      "2                             NaN         NaN                       NaN   \n",
      "3  Human Development Index (HDI)          NaN  Life expectancy at birth   \n",
      "4                           Value         NaN                   (years)   \n",
      "\n",
      "  Unnamed: 5                   Unnamed: 6 Unnamed: 7               Unnamed: 8  \\\n",
      "0        NaN                          NaN        NaN                      NaN   \n",
      "1        NaN                       SDG4.3        NaN                   SDG4.4   \n",
      "2        NaN                          NaN        NaN                      NaN   \n",
      "3        NaN  Expected years of schooling        NaN  Mean years of schooling   \n",
      "4        NaN                      (years)        NaN                  (years)   \n",
      "\n",
      "  Unnamed: 9                             Unnamed: 10 Unnamed: 11  \\\n",
      "0        NaN                                     NaN         NaN   \n",
      "1        NaN                                  SDG8.5         NaN   \n",
      "2        NaN                                     NaN         NaN   \n",
      "3        NaN  Gross national income (GNI) per capita         NaN   \n",
      "4        NaN                            (2017 PPP $)         NaN   \n",
      "\n",
      "                          Unnamed: 12 Unnamed: 13 Unnamed: 14 Unnamed: 15  \n",
      "0                                 NaN         NaN         NaN         NaN  \n",
      "1                                 NaN         NaN         NaN         NaN  \n",
      "2                                 NaN         NaN         NaN         NaN  \n",
      "3  GNI per capita rank minus HDI rank         NaN    HDI rank         NaN  \n",
      "4                                 NaN         NaN         NaN         NaN  \n",
      "Datos de Level 2:\n",
      "    HDI rank                 Country  Human Development Index (HDI)   \\\n",
      "0       NaN                     NaN                        2021.000   \n",
      "1       NaN  HIGH HUMAN DEVELOPMENT                             NaN   \n",
      "2      67.0                 Albania                           0.796   \n",
      "3      68.0                Bulgaria                           0.795   \n",
      "4      68.0                 Grenada                           0.795   \n",
      "\n",
      "   Life expectancy at birth  Expected years of schooling  \\\n",
      "0                 2021.0000                   2021.00000   \n",
      "1                       NaN                          NaN   \n",
      "2                   76.4626                     14.44800   \n",
      "3                   71.7980                     13.89729   \n",
      "4                   74.9362                     18.66202   \n",
      "\n",
      "   Mean years of schooling Unnamed: 6  Gross national income (GNI) per capita  \\\n",
      "0              2021.000000          a                              2021.00000   \n",
      "1                      NaN        NaN                                     NaN   \n",
      "2                11.286455          e                             14131.11039   \n",
      "3                11.413180        NaN                             23078.95595   \n",
      "4                 9.032104          l                             13483.57740   \n",
      "\n",
      "  Unnamed: 8  GNI per capita rank minus HDI rank Unnamed: 10  HDI rank.1  \n",
      "0        NaN                              2021.0           b      2020.0  \n",
      "1        NaN                                 NaN         NaN         NaN  \n",
      "2        NaN                                17.0         NaN        68.0  \n",
      "3        NaN                                -8.0         NaN        64.0  \n",
      "4        NaN                                18.0         NaN        70.0  \n",
      "Datos de Level 3:\n",
      "    HDI rank                           Country  Human Development Index (HDI)   \\\n",
      "0       NaN                               NaN                        2021.000   \n",
      "1       NaN          MEDIUM HUMAN DEVELOPMENT                             NaN   \n",
      "2     116.0                       Philippines                           0.699   \n",
      "3     117.0                          Botswana                           0.693   \n",
      "4     118.0  Bolivia (Plurinational State of)                           0.692   \n",
      "\n",
      "   Unnamed: 3  Life expectancy at birth  Unnamed: 5  \\\n",
      "0         NaN                 2021.0000         NaN   \n",
      "1         NaN                       NaN         NaN   \n",
      "2         NaN                   69.2664         NaN   \n",
      "3         NaN                   61.1409         NaN   \n",
      "4         NaN                   63.6304         NaN   \n",
      "\n",
      "   Expected years of schooling Unnamed: 7  Mean years of schooling Unnamed: 9  \\\n",
      "0                  2021.000000          a               2021.00000          a   \n",
      "1                          NaN        NaN                      NaN        NaN   \n",
      "2                    13.126570        NaN                  8.96910        NaN   \n",
      "3                    12.265138          e                 10.34000        NaN   \n",
      "4                    14.946971        NaN                  9.82775        NaN   \n",
      "\n",
      "   Gross national income (GNI) per capita Unnamed: 11  \\\n",
      "0                             2021.000000         NaN   \n",
      "1                                     NaN         NaN   \n",
      "2                             8920.428468         NaN   \n",
      "3                            16198.318410         NaN   \n",
      "4                             8111.190194         NaN   \n",
      "\n",
      "   GNI per capita rank minus HDI rank Unnamed: 13  HDI rank.1  \n",
      "0                              2021.0           b      2020.0  \n",
      "1                                 NaN         NaN         NaN  \n",
      "2                                -3.0         NaN       113.0  \n",
      "3                               -43.0         NaN       110.0  \n",
      "4                                 0.0         NaN       119.0  \n",
      "Datos de Level 4:\n",
      "    HDI rank                        Country             Unnamed: 2  \\\n",
      "0       160  Tanzania (United Republic of)  LOW HUMAN DEVELOPMENT   \n",
      "1       161                       Pakistan  LOW HUMAN DEVELOPMENT   \n",
      "2       162                           Togo  LOW HUMAN DEVELOPMENT   \n",
      "3       163                          Haiti  LOW HUMAN DEVELOPMENT   \n",
      "4       163                        Nigeria  LOW HUMAN DEVELOPMENT   \n",
      "\n",
      "   Human Development Index (HDI)   Life expectancy at birth  \\\n",
      "0                           0.549                   66.2007   \n",
      "1                           0.544                   66.0979   \n",
      "2                           0.539                   61.6194   \n",
      "3                           0.535                   63.1924   \n",
      "4                           0.535                   52.6760   \n",
      "\n",
      "   Expected years of schooling  Mean years of schooling  \\\n",
      "0                     9.221490                 6.372899   \n",
      "1                     8.658350                 4.536330   \n",
      "2                    12.950494                 5.016807   \n",
      "3                     9.700000                 5.554000   \n",
      "4                    10.127584                 7.181074   \n",
      "\n",
      "   Gross national income (GNI) per capita  GNI per capita rank minus HDI rank  \\\n",
      "0                             2664.329096                                   7   \n",
      "1                             4623.705430                                 -19   \n",
      "2                             2166.619062                                  12   \n",
      "3                             2847.500746                                   2   \n",
      "4                             4790.284425                                 -22   \n",
      "\n",
      "   le  \n",
      "0 NaN  \n",
      "1 NaN  \n",
      "2 NaN  \n",
      "3 NaN  \n",
      "4 NaN  \n",
      "Datos de Country Codes:\n",
      "                Country                            Officialstatename  \\\n",
      "0          AFGHANISTAN          The Islamic Republic of Afghanistan   \n",
      "1              ALBANIA                      The Republic of Albania   \n",
      "2              ALGERIA  The People's Democratic Republic of Algeria   \n",
      "3               ANGOLA                       The Republic of Angola   \n",
      "4  ANTIGUA AND BARBUDA                          Antigua and Barbuda   \n",
      "\n",
      "  InternetccTLD iso2 iso3  \n",
      "0           .af   AF  AFG  \n",
      "1           .al   AL  ALB  \n",
      "2           .dz   DZ  DZA  \n",
      "3           .ao   AO  AGO  \n",
      "4           .ag   AG  ATG  \n"
     ]
    }
   ],
   "source": [
    "# Integre los archivos que están el folder comprimido (appendData.zip)\n",
    "\n",
    "\n",
    "#!pip install pandas openpyxl\n",
    "import pandas as pd\n",
    "# Cargamos el archivos de los niveles\n",
    "level1_df = pd.read_excel('C:/Users/ESLEITER/Downloads/DATOS ESPACIALES/pc3/appendData/level1.xlsx')\n",
    "level2_df = pd.read_excel('C:/Users/ESLEITER/Downloads/DATOS ESPACIALES/pc3/appendData/level2.xlsx')\n",
    "level3_df = pd.read_excel('C:/Users/ESLEITER/Downloads/DATOS ESPACIALES/pc3/appendData/level3.xlsx')\n",
    "level4_df = pd.read_excel('C:/Users/ESLEITER/Downloads/DATOS ESPACIALES/pc3/appendData/level4.xlsx')\n",
    "# Cargamos el archivo de códigos de países\n",
    "country_codes_df = pd.read_excel('C:/Users/ESLEITER/Downloads/DATOS ESPACIALES/pc3/countryCODES.xlsx')\n",
    "# Verificamos los datos de registros cargados\n",
    "print(\"Datos de Level 1:\\n\", level1_df.head())\n",
    "print(\"Datos de Level 2:\\n\", level2_df.head())\n",
    "print(\"Datos de Level 3:\\n\", level3_df.head())\n",
    "print(\"Datos de Level 4:\\n\", level4_df.head())\n",
    "print(\"Datos de Country Codes:\\n\", country_codes_df.head())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 95,
   "id": "e5a5b54b-8b9d-4550-ac4e-3d0b5f71e93c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Datos limpios de Level 1:\n",
      "   HDI rank                 Country Human Development Index (HDI)   \\\n",
      "0       1.0             Switzerland                          0.962   \n",
      "1       2.0                  Norway                          0.961   \n",
      "2       3.0                 Iceland                          0.959   \n",
      "3       4.0  Hong Kong, China (SAR)                          0.952   \n",
      "4       5.0               Australia                          0.951   \n",
      "\n",
      "  Life expectancy at birth Expected years of schooling  \\\n",
      "0                  83.9872                   16.500299   \n",
      "1                  83.2339                     18.1852   \n",
      "2                  82.6782                   19.163059   \n",
      "3                  85.4734                    17.27817   \n",
      "4                  84.5265                    21.05459   \n",
      "\n",
      "  Mean years of schooling Gross national income (GNI) per capita  \\\n",
      "0                13.85966                            66933.00454   \n",
      "1                13.00363                            64660.10622   \n",
      "2                13.76717                            55782.04981   \n",
      "3                12.22621                             62606.8454   \n",
      "4                12.72682                            49238.43335   \n",
      "\n",
      "   GNI per capita rank minus HDI rank  HDI rank.1  \n",
      "0                                 5.0         3.0  \n",
      "1                                 6.0         1.0  \n",
      "2                                11.0         2.0  \n",
      "3                                 6.0         4.0  \n",
      "4                                18.0         5.0  \n"
     ]
    }
   ],
   "source": [
    "# TRABAJAMOS EN LIMPIAR EL ARCHIVO LEVEL1\n",
    "# Eliminar las filas 1 y 2\n",
    "level1_df = pd.read_excel('C:/Users/ESLEITER/Downloads/DATOS ESPACIALES/pc3/appendData/level1.xlsx', header=4)\n",
    "level1_df_clean = level1_df.drop([0,1])\n",
    "# Eliminar columnas que no tienen nombre (sin encabezados)\n",
    "level1_df_clean = level1_df_clean.loc[:, ~level1_df_clean.columns.str.contains('^Unnamed')]\n",
    "# Reiniciar los índices después de eliminar las filas\n",
    "level1_df_clean.reset_index(drop=True, inplace=True)\n",
    "# Mostrar las primeras filas del archivo limpio\n",
    "print(\"Datos limpios de Level 1:\")\n",
    "print(level1_df_clean.head()) "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 107,
   "id": "21bf4729-4aff-4de6-a279-7d62a5237aa2",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Datos limpios de Level 2:\n",
      "   HDI rank              Country  Human Development Index (HDI)   \\\n",
      "2      67.0              Albania                           0.796   \n",
      "3      68.0             Bulgaria                           0.795   \n",
      "4      68.0              Grenada                           0.795   \n",
      "5      70.0             Barbados                           0.790   \n",
      "6      71.0  Antigua and Barbuda                           0.788   \n",
      "\n",
      "   Life expectancy at birth  Expected years of schooling  \\\n",
      "2                   76.4626                    14.448000   \n",
      "3                   71.7980                    13.897290   \n",
      "4                   74.9362                    18.662020   \n",
      "5                   77.5714                    15.713385   \n",
      "6                   78.4968                    14.184626   \n",
      "\n",
      "   Mean years of schooling  Gross national income (GNI) per capita  \\\n",
      "2                11.286455                             14131.11039   \n",
      "3                11.413180                             23078.95595   \n",
      "4                 9.032104                             13483.57740   \n",
      "5                 9.852701                             12306.34100   \n",
      "6                 9.293741                             16792.36595   \n",
      "\n",
      "   GNI per capita rank minus HDI rank  HDI rank.1  \n",
      "2                                17.0        68.0  \n",
      "3                                -8.0        64.0  \n",
      "4                                18.0        70.0  \n",
      "5                                26.0        71.0  \n",
      "6                                 2.0        71.0  \n"
     ]
    }
   ],
   "source": [
    "# TRABAJAMOS EN LIMPIAR EL ARCHIVO LEVEL2\n",
    "level2_df = pd.read_excel('C:/Users/ESLEITER/Downloads/DATOS ESPACIALES/pc3/appendData/level2.xlsx', header=0)\n",
    "# Eliminar las filas 2 y 3\n",
    "level2_df_clean = level2_df.drop([0,1])\n",
    "# Eliminar columnas que no tienen nombre (sin encabezados)\n",
    "level2_df_clean = level2_df_clean.loc[:, ~level2_df_clean.columns.str.contains('^Unnamed')]\n",
    "# Mostrar las primeras filas del archivo limpio\n",
    "print(\"Datos limpios de Level 2:\")\n",
    "print(level2_df_clean.head())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 105,
   "id": "d1fcd46a-3a5e-4a19-8803-792bdf249d46",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Datos limpios de Level 3:\n",
      "   HDI rank                             Country  \\\n",
      "0     116.0                         Philippines   \n",
      "1     117.0                            Botswana   \n",
      "2     118.0    Bolivia (Plurinational State of)   \n",
      "3     118.0                          Kyrgyzstan   \n",
      "4     120.0  Venezuela (Bolivarian Republic of)   \n",
      "\n",
      "   Human Development Index (HDI)   Life expectancy at birth  \\\n",
      "0                           0.699                   69.2664   \n",
      "1                           0.693                   61.1409   \n",
      "2                           0.692                   63.6304   \n",
      "3                           0.692                   69.9774   \n",
      "4                           0.691                   70.5536   \n",
      "\n",
      "   Expected years of schooling  Mean years of schooling  \\\n",
      "0                    13.126570                 8.969100   \n",
      "1                    12.265138                10.340000   \n",
      "2                    14.946971                 9.827750   \n",
      "3                    13.195300                11.374106   \n",
      "4                    12.816080                11.107277   \n",
      "\n",
      "   Gross national income (GNI) per capita  GNI per capita rank minus HDI rank  \\\n",
      "0                             8920.428468                                -3.0   \n",
      "1                            16198.318410                               -43.0   \n",
      "2                             8111.190194                                 0.0   \n",
      "3                             4566.303831                                26.0   \n",
      "4                             4810.882621                                20.0   \n",
      "\n",
      "   HDI rank.1  \n",
      "0       113.0  \n",
      "1       110.0  \n",
      "2       119.0  \n",
      "3       121.0  \n",
      "4       118.0  \n"
     ]
    }
   ],
   "source": [
    "# TRABAJAMOS EN LIMPIAR EL ARCHIVO LEVEL3\n",
    "level3_df = pd.read_excel('C:/Users/ESLEITER/Downloads/DATOS ESPACIALES/pc3/appendData/level3.xlsx', header=0)\n",
    "# Eliminar las filas 2 y 3 (recuerda que los índices empiezan desde 0)\n",
    "level3_df_clean = level3_df.drop([0,1])\n",
    "# Eliminamos las columnas que no tienen nombre\n",
    "level3_df_clean = level3_df_clean.loc[:, ~level3_df_clean.columns.str.contains('^Unnamed')]\n",
    "# Reiniciar los índices después de eliminar las filas\n",
    "level3_df_clean.reset_index(drop=True, inplace=True)\n",
    "\n",
    "# Mostramos los datos limpios del archivo\n",
    "print(\"Datos limpios de Level 3:\")\n",
    "print(level3_df_clean.head()) "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 135,
   "id": "0118cb95-a8a4-495c-8013-e4d7aa79e0b8",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Datos limpios de Level 4:\n",
      "   HDI rank                        Country  Human Development Index (HDI)   \\\n",
      "0       160  Tanzania (United Republic of)                           0.549   \n",
      "1       161                       Pakistan                           0.544   \n",
      "2       162                           Togo                           0.539   \n",
      "3       163                          Haiti                           0.535   \n",
      "4       163                        Nigeria                           0.535   \n",
      "\n",
      "   Life expectancy at birth  Expected years of schooling  \\\n",
      "0                   66.2007                     9.221490   \n",
      "1                   66.0979                     8.658350   \n",
      "2                   61.6194                    12.950494   \n",
      "3                   63.1924                     9.700000   \n",
      "4                   52.6760                    10.127584   \n",
      "\n",
      "   Mean years of schooling  Gross national income (GNI) per capita  \\\n",
      "0                 6.372899                             2664.329096   \n",
      "1                 4.536330                             4623.705430   \n",
      "2                 5.016807                             2166.619062   \n",
      "3                 5.554000                             2847.500746   \n",
      "4                 7.181074                             4790.284425   \n",
      "\n",
      "   GNI per capita rank minus HDI rank  \n",
      "0                                   7  \n",
      "1                                 -19  \n",
      "2                                  12  \n",
      "3                                   2  \n",
      "4                                 -22  \n"
     ]
    }
   ],
   "source": [
    "# TRABAJAMOS EN LIMPIAR EL ARCHIVO LEVEL4\n",
    "level4_df = pd.read_excel('C:/Users/ESLEITER/Downloads/DATOS ESPACIALES/pc3/appendData/level4.xlsx', header=0)\n",
    "# Eliminar columnas completamente vacías\n",
    "level4_df.dropna(how='all', axis=1, inplace=True)\n",
    "# Eliminar columnas que no tienen nombre (sin encabezados)\n",
    "level4_df_clean = level4_df.loc[:, ~level4_df.columns.str.contains('^Unnamed')].copy()  # Hacer una copia\n",
    "\n",
    "# Mostrar las primeras filas del DataFrame limpio\n",
    "print(\"Datos limpios de Level 4:\")\n",
    "print(level4_df_clean.head())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 201,
   "id": "91df33ae-7525-4a37-bf65-3fb00581f2c1",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "   HDI rank                 Country Human Development Index (HDI)   \\\n",
      "0       1.0             Switzerland                          0.962   \n",
      "1       2.0                  Norway                          0.961   \n",
      "2       3.0                 Iceland                          0.959   \n",
      "3       4.0  Hong Kong, China (SAR)                          0.952   \n",
      "4       5.0               Australia                          0.951   \n",
      "\n",
      "  Life expectancy at birth Expected years of schooling  \\\n",
      "0                  83.9872                   16.500299   \n",
      "1                  83.2339                     18.1852   \n",
      "2                  82.6782                   19.163059   \n",
      "3                  85.4734                    17.27817   \n",
      "4                  84.5265                    21.05459   \n",
      "\n",
      "  Mean years of schooling Gross national income (GNI) per capita  \\\n",
      "0                13.85966                            66933.00454   \n",
      "1                13.00363                            64660.10622   \n",
      "2                13.76717                            55782.04981   \n",
      "3                12.22621                             62606.8454   \n",
      "4                12.72682                            49238.43335   \n",
      "\n",
      "   GNI per capita rank minus HDI rank  HDI rank.1  \n",
      "0                                 5.0         3.0  \n",
      "1                                 6.0         1.0  \n",
      "2                                11.0         2.0  \n",
      "3                                 6.0         4.0  \n",
      "4                                18.0         5.0  \n"
     ]
    }
   ],
   "source": [
    "#Cuando haya integrado los archivos anteriores, haga un merge entre ese archivo, y el archivo countryCODES.xlsx\n",
    "\n",
    "\n",
    "# Combinamos todos los DataFrames en uno solo\n",
    "merged_df = pd.concat([level1_df_clean, level2_df_clean, level3_df_clean, level4_df_clean], ignore_index=True)\n",
    "\n",
    "# Verificamos el resultado de la combinación\n",
    "print(merged_df.head())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 171,
   "id": "d108e3a8-41a1-48c7-b848-56a78d3b83f0",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "   HDI rank                 Country Human Development Index (HDI)  \\\n",
      "0       1.0             Switzerland                         0.962   \n",
      "1       2.0                  Norway                         0.961   \n",
      "2       3.0                 Iceland                         0.959   \n",
      "3       4.0  Hong Kong, China (SAR)                         0.952   \n",
      "4       5.0               Australia                         0.951   \n",
      "\n",
      "  Life expectancy at birth Expected years of schooling  \\\n",
      "0                  83.9872                   16.500299   \n",
      "1                  83.2339                     18.1852   \n",
      "2                  82.6782                   19.163059   \n",
      "3                  85.4734                    17.27817   \n",
      "4                  84.5265                    21.05459   \n",
      "\n",
      "  Mean years of schooling Gross national income (GNI) per capita  \\\n",
      "0                13.85966                            66933.00454   \n",
      "1                13.00363                            64660.10622   \n",
      "2                13.76717                            55782.04981   \n",
      "3                12.22621                             62606.8454   \n",
      "4                12.72682                            49238.43335   \n",
      "\n",
      "   GNI per capita rank minus HDI rank  HDI rank.1 Officialstatename  \\\n",
      "0                                 5.0         3.0               NaN   \n",
      "1                                 6.0         1.0               NaN   \n",
      "2                                11.0         2.0               NaN   \n",
      "3                                 6.0         4.0               NaN   \n",
      "4                                18.0         5.0               NaN   \n",
      "\n",
      "  InternetccTLD iso2 iso3  \n",
      "0           NaN  NaN  NaN  \n",
      "1           NaN  NaN  NaN  \n",
      "2           NaN  NaN  NaN  \n",
      "3           NaN  NaN  NaN  \n",
      "4           NaN  NaN  NaN  \n"
     ]
    }
   ],
   "source": [
    "# Cargamos el archivo countryCODES.xlsx\n",
    "country_codes_df = pd.read_excel('C:/Users/ESLEITER/Downloads/DATOS ESPACIALES/pc3/countryCODES.xlsx')\n",
    "# Realizamos el merge con los datos dados usando la columna 'Country'\n",
    "final_df = pd.merge(merged_df, country_codes_df, on='Country', how='left')\n",
    "\n",
    "# Verificar el resultado\n",
    "print(final_df.head())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 185,
   "id": "057664bc-6fc2-4b11-b3a9-5c041541858e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "   HDI rank                 Country Human Development Index (HDI)  \\\n",
      "0       1.0             Switzerland                         0.962   \n",
      "1       2.0                  Norway                         0.961   \n",
      "2       3.0                 Iceland                         0.959   \n",
      "3       4.0  Hong Kong, China (SAR)                         0.952   \n",
      "4       5.0               Australia                         0.951   \n",
      "\n",
      "  Life expectancy at birth Expected years of schooling  \\\n",
      "0                  83.9872                   16.500299   \n",
      "1                  83.2339                     18.1852   \n",
      "2                  82.6782                   19.163059   \n",
      "3                  85.4734                    17.27817   \n",
      "4                  84.5265                    21.05459   \n",
      "\n",
      "  Mean years of schooling Gross national income (GNI) per capita  \\\n",
      "0                13.85966                            66933.00454   \n",
      "1                13.00363                            64660.10622   \n",
      "2                13.76717                            55782.04981   \n",
      "3                12.22621                             62606.8454   \n",
      "4                12.72682                            49238.43335   \n",
      "\n",
      "   GNI per capita rank minus HDI rank  HDI rank.1 Officialstatename  \\\n",
      "0                                 5.0         3.0               NaN   \n",
      "1                                 6.0         1.0               NaN   \n",
      "2                                11.0         2.0               NaN   \n",
      "3                                 6.0         4.0               NaN   \n",
      "4                                18.0         5.0               NaN   \n",
      "\n",
      "  InternetccTLD iso2 iso3  \n",
      "0           NaN  NaN  NaN  \n",
      "1           NaN  NaN  NaN  \n",
      "2           NaN  NaN  NaN  \n",
      "3           NaN  NaN  NaN  \n",
      "4           NaN  NaN  NaN  \n"
     ]
    }
   ],
   "source": [
    "# Cargamos el archivo countryCODES.xlsx\n",
    "country_codes_df = pd.read_excel('C:/Users/ESLEITER/Downloads/DATOS ESPACIALES/pc3/countryCODES.xlsx')\n",
    "# Realizamos el merge con los datos dados usando la columna 'Country'\n",
    "final_df = pd.merge(merged_df, country_codes_df, on='Country', how='left')\n",
    "# Aseguramos que 'Officialstatename' retenga las letras del Excel original\n",
    "if 'Officialstatename_y' in final_df.columns:\n",
    "    final_df['Officialstatename'] = final_df['Officialstatename'].fillna(final_df['Officialstatename_y'])\n",
    "# Eliminamos la columna innecesaria 'Officialstatename_y'\n",
    "final_df.drop(columns=['Officialstatename_y'], inplace=True, errors='ignore')\n",
    "\n",
    "# Verificar el resultado\n",
    "print(final_df.head())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 207,
   "id": "7db295f2-b077-4ceb-9f96-5f408dbd124a",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Mes y Año: 2020-03, Fallecidos: 181\n",
      "Mes y Año: 2020-04, Fallecidos: 5134\n",
      "Mes y Año: 2020-05, Fallecidos: 16363\n",
      "Mes y Año: 2020-06, Fallecidos: 17462\n",
      "Mes y Año: 2020-07, Fallecidos: 18501\n",
      "Mes y Año: 2020-08, Fallecidos: 17668\n",
      "Mes y Año: 2020-09, Fallecidos: 8437\n",
      "Mes y Año: 2020-10, Fallecidos: 4471\n",
      "Mes y Año: 2020-11, Fallecidos: 3229\n",
      "Mes y Año: 2020-12, Fallecidos: 3885\n",
      "Mes y Año: 2021-01, Fallecidos: 11175\n",
      "Mes y Año: 2021-02, Fallecidos: 18645\n",
      "Mes y Año: 2021-03, Fallecidos: 20691\n",
      "Mes y Año: 2021-04, Fallecidos: 23110\n",
      "Mes y Año: 2021-05, Fallecidos: 16692\n",
      "Mes y Año: 2021-06, Fallecidos: 7722\n",
      "Mes y Año: 2021-07, Fallecidos: 3481\n",
      "Mes y Año: 2021-08, Fallecidos: 1850\n",
      "Mes y Año: 2021-09, Fallecidos: 1140\n",
      "Mes y Año: 2021-10, Fallecidos: 1066\n",
      "Mes y Año: 2021-11, Fallecidos: 1107\n",
      "Mes y Año: 2021-12, Fallecidos: 1283\n",
      "Mes y Año: 2022-01, Fallecidos: 3562\n",
      "Mes y Año: 2022-02, Fallecidos: 3503\n",
      "Mes y Año: 2022-03, Fallecidos: 1299\n",
      "Mes y Año: 2022-04, Fallecidos: 741\n",
      "Mes y Año: 2022-05, Fallecidos: 625\n",
      "Mes y Año: 2022-06, Fallecidos: 542\n",
      "Mes y Año: 2022-07, Fallecidos: 1025\n",
      "Mes y Año: 2022-08, Fallecidos: 1429\n",
      "Mes y Año: 2022-09, Fallecidos: 892\n",
      "Mes y Año: 2022-10, Fallecidos: 429\n",
      "Mes y Año: 2022-11, Fallecidos: 272\n",
      "Mes y Año: 2022-12, Fallecidos: 423\n",
      "Mes y Año: 2023-01, Fallecidos: 371\n",
      "Mes y Año: 2023-02, Fallecidos: 287\n",
      "Mes y Año: 2023-03, Fallecidos: 295\n",
      "Mes y Año: 2023-04, Fallecidos: 337\n",
      "Mes y Año: 2023-05, Fallecidos: 323\n",
      "Mes y Año: 2023-06, Fallecidos: 291\n",
      "Mes y Año: 2023-07, Fallecidos: 258\n",
      "Mes y Año: 2023-08, Fallecidos: 249\n",
      "Mes y Año: 2023-09, Fallecidos: 60\n",
      "Mes y Año: 2023-10, Fallecidos: 26\n",
      "Mes y Año: 2023-11, Fallecidos: 33\n",
      "Mes y Año: 2023-12, Fallecidos: 40\n",
      "Mes y Año: 2024-01, Fallecidos: 249\n",
      "Mes y Año: 2024-02, Fallecidos: 62\n",
      "Mes y Año: 2024-03, Fallecidos: 2\n"
     ]
    }
   ],
   "source": [
    "#Con los archivos fallecidosCOVID.csv,  haga un reporte mensual de fallecidos.\n",
    "#Solo debe mostrar por fila el mes (y año) y cuanto fallecidos hubo en ese mes.\n",
    "\n",
    "\n",
    "import pandas as pd\n",
    "\n",
    "# Cargamos el archivo CSV\n",
    "fallecidos_df = 'C:/Users/ESLEITER/Downloads/DATOS ESPACIALES/pc3/fallecidosCOVID.csv'\n",
    "covid_data = pd.read_csv(fallecidos_df, sep=';')\n",
    "# Convertimos la columna 'FECHA_FALLECIMIENTO' a formato de fecha\n",
    "covid_data['FECHA_FALLECIMIENTO'] = pd.to_datetime(covid_data['FECHA_FALLECIMIENTO'], format='%Y%m%d', errors='coerce')\n",
    "# Agrupamos los datos por mes y año, se cuenta la cantidad de fallecidos en cada mes\n",
    "month_death = covid_data.groupby(covid_data['FECHA_FALLECIMIENTO'].dt.to_period('M')).size().reset_index(name='Fallecidos')\n",
    "\n",
    "# Imprimimos el reporte mensual de fallecidos con el formato adecuado\n",
    "for index, row in month_death.iterrows():\n",
    "    print(f\"Mes y Año: {row['FECHA_FALLECIMIENTO']}, Fallecidos: {row['Fallecidos']}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "61e9ff77-ec2c-4cda-94b1-660a4411b6f2",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 209,
   "id": "c3a5d616-1656-449a-9109-bdddc59bc74a",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CLASIFICACION_DEF    Criterio SINADEF  Criterio clínico  \\\n",
      "FECHA_FALLECIMIENTO                                       \n",
      "2020-03                            35                52   \n",
      "2020-04                          1793               541   \n",
      "2020-05                          6826              1152   \n",
      "2020-06                          5722               670   \n",
      "2020-07                          5012               609   \n",
      "2020-08                          4589               611   \n",
      "2020-09                          1984               475   \n",
      "2020-10                          1091               463   \n",
      "2020-11                           704               462   \n",
      "2020-12                           802               547   \n",
      "2021-01                          2190               514   \n",
      "2021-02                          4993               501   \n",
      "2021-03                          6100               525   \n",
      "2021-04                          7450               748   \n",
      "2021-05                          5225               628   \n",
      "2021-06                          2723               116   \n",
      "2021-07                          1025               113   \n",
      "2021-08                           578                75   \n",
      "2021-09                           554                12   \n",
      "2021-10                           469                12   \n",
      "2021-11                           441                16   \n",
      "2021-12                           585                 8   \n",
      "2022-01                          1894                22   \n",
      "2022-02                          1604                20   \n",
      "2022-03                           352                 6   \n",
      "2022-04                           131                 9   \n",
      "2022-05                            85                 3   \n",
      "2022-06                            81                 3   \n",
      "2022-07                           299                 3   \n",
      "2022-08                           405                 6   \n",
      "2022-09                           154                12   \n",
      "2022-10                            53                59   \n",
      "2022-11                            23                 0   \n",
      "2022-12                            66                 0   \n",
      "2023-01                            34                 1   \n",
      "2023-02                             4                 0   \n",
      "2023-03                             6                 0   \n",
      "2023-04                            17                 0   \n",
      "2023-05                             6                 0   \n",
      "2023-06                             2                 0   \n",
      "2023-07                             3                 0   \n",
      "2023-08                             7                 0   \n",
      "2023-09                             7                 0   \n",
      "2023-10                             8                 0   \n",
      "2023-11                            13                 0   \n",
      "2023-12                            17                 0   \n",
      "2024-01                            35                 0   \n",
      "2024-02                             1                 0   \n",
      "2024-03                             0                 0   \n",
      "\n",
      "CLASIFICACION_DEF    Criterio investigación Epidemiológica  \\\n",
      "FECHA_FALLECIMIENTO                                          \n",
      "2020-03                                                 25   \n",
      "2020-04                                                498   \n",
      "2020-05                                               1427   \n",
      "2020-06                                               1706   \n",
      "2020-07                                               1512   \n",
      "2020-08                                               1456   \n",
      "2020-09                                                755   \n",
      "2020-10                                                469   \n",
      "2020-11                                                307   \n",
      "2020-12                                                171   \n",
      "2021-01                                                323   \n",
      "2021-02                                                465   \n",
      "2021-03                                                517   \n",
      "2021-04                                                591   \n",
      "2021-05                                                349   \n",
      "2021-06                                                123   \n",
      "2021-07                                                 67   \n",
      "2021-08                                                 22   \n",
      "2021-09                                                  0   \n",
      "2021-10                                                  0   \n",
      "2021-11                                                  0   \n",
      "2021-12                                                  0   \n",
      "2022-01                                                  0   \n",
      "2022-02                                                  0   \n",
      "2022-03                                                  0   \n",
      "2022-04                                                  0   \n",
      "2022-05                                                  0   \n",
      "2022-06                                                  0   \n",
      "2022-07                                                  0   \n",
      "2022-08                                                  0   \n",
      "2022-09                                                  0   \n",
      "2022-10                                                  0   \n",
      "2022-11                                                  0   \n",
      "2022-12                                                  0   \n",
      "2023-01                                                  0   \n",
      "2023-02                                                  0   \n",
      "2023-03                                                  0   \n",
      "2023-04                                                  0   \n",
      "2023-05                                                  0   \n",
      "2023-06                                                  0   \n",
      "2023-07                                                  0   \n",
      "2023-08                                                  0   \n",
      "2023-09                                                  0   \n",
      "2023-10                                                  0   \n",
      "2023-11                                                  0   \n",
      "2023-12                                                  0   \n",
      "2024-01                                                  0   \n",
      "2024-02                                                  0   \n",
      "2024-03                                                  0   \n",
      "\n",
      "CLASIFICACION_DEF    Criterio nexo epidemiológico  Criterio radiológico  \\\n",
      "FECHA_FALLECIMIENTO                                                       \n",
      "2020-03                                         2                     7   \n",
      "2020-04                                        68                   182   \n",
      "2020-05                                       203                   480   \n",
      "2020-06                                       251                   391   \n",
      "2020-07                                       262                   415   \n",
      "2020-08                                       208                   534   \n",
      "2020-09                                       105                   233   \n",
      "2020-10                                        50                   172   \n",
      "2020-11                                        37                   186   \n",
      "2020-12                                        41                   179   \n",
      "2021-01                                       107                   434   \n",
      "2021-02                                       150                   556   \n",
      "2021-03                                       229                   456   \n",
      "2021-04                                       246                   363   \n",
      "2021-05                                       155                   283   \n",
      "2021-06                                        51                   138   \n",
      "2021-07                                        35                    68   \n",
      "2021-08                                        15                    36   \n",
      "2021-09                                         0                     0   \n",
      "2021-10                                         0                     0   \n",
      "2021-11                                         0                     0   \n",
      "2021-12                                         0                     0   \n",
      "2022-01                                         0                     0   \n",
      "2022-02                                         0                     0   \n",
      "2022-03                                         0                     0   \n",
      "2022-04                                         0                     0   \n",
      "2022-05                                         0                     0   \n",
      "2022-06                                         0                     0   \n",
      "2022-07                                         0                     0   \n",
      "2022-08                                         0                     0   \n",
      "2022-09                                         0                     0   \n",
      "2022-10                                         0                     0   \n",
      "2022-11                                         0                     0   \n",
      "2022-12                                         0                     0   \n",
      "2023-01                                         0                     0   \n",
      "2023-02                                         0                     0   \n",
      "2023-03                                         0                     0   \n",
      "2023-04                                         0                     0   \n",
      "2023-05                                         0                     0   \n",
      "2023-06                                         0                     0   \n",
      "2023-07                                         0                     0   \n",
      "2023-08                                         0                     0   \n",
      "2023-09                                         0                     0   \n",
      "2023-10                                         0                     0   \n",
      "2023-11                                         0                     0   \n",
      "2023-12                                         0                     0   \n",
      "2024-01                                         0                     0   \n",
      "2024-02                                         0                     0   \n",
      "2024-03                                         0                     0   \n",
      "\n",
      "CLASIFICACION_DEF    Criterio serológico  Criterio virológico  NotiCovid  \\\n",
      "FECHA_FALLECIMIENTO                                                        \n",
      "2020-03                                2                   58          0   \n",
      "2020-04                              778                 1274          0   \n",
      "2020-05                             3233                 3042          0   \n",
      "2020-06                             5605                 3117          0   \n",
      "2020-07                             7501                 3190          0   \n",
      "2020-08                             7400                 2870          0   \n",
      "2020-09                             3483                 1402          0   \n",
      "2020-10                             1417                  809          0   \n",
      "2020-11                              867                  666          0   \n",
      "2020-12                             1047                 1098          0   \n",
      "2021-01                             2448                 5159          0   \n",
      "2021-02                             2539                 9441          0   \n",
      "2021-03                             1703                11161          0   \n",
      "2021-04                             1488                12224          0   \n",
      "2021-05                             1175                 8877          0   \n",
      "2021-06                              746                 3825          0   \n",
      "2021-07                              521                 1652          0   \n",
      "2021-08                              287                  837          0   \n",
      "2021-09                              190                  384          0   \n",
      "2021-10                              148                  437          0   \n",
      "2021-11                              157                  493          0   \n",
      "2021-12                              133                  557          0   \n",
      "2022-01                               41                 1605          0   \n",
      "2022-02                                1                 1878          0   \n",
      "2022-03                                0                  941          0   \n",
      "2022-04                                0                  601          0   \n",
      "2022-05                                0                  537          0   \n",
      "2022-06                                0                  458          0   \n",
      "2022-07                                0                  723          0   \n",
      "2022-08                                0                 1018          0   \n",
      "2022-09                                0                  726          0   \n",
      "2022-10                                0                  317          0   \n",
      "2022-11                                0                  249          0   \n",
      "2022-12                                0                  357          0   \n",
      "2023-01                                0                  336          0   \n",
      "2023-02                                0                  283          0   \n",
      "2023-03                                0                  289          0   \n",
      "2023-04                                0                  320          0   \n",
      "2023-05                                0                  317          0   \n",
      "2023-06                                0                  289          0   \n",
      "2023-07                                0                  255          0   \n",
      "2023-08                                0                  242          0   \n",
      "2023-09                                0                   53          0   \n",
      "2023-10                                0                   18          0   \n",
      "2023-11                                0                   20          0   \n",
      "2023-12                                0                   22          1   \n",
      "2024-01                                0                   83        115   \n",
      "2024-02                                0                   45         16   \n",
      "2024-03                                0                    2          0   \n",
      "\n",
      "CLASIFICACION_DEF    sinadef  \n",
      "FECHA_FALLECIMIENTO           \n",
      "2020-03                    0  \n",
      "2020-04                    0  \n",
      "2020-05                    0  \n",
      "2020-06                    0  \n",
      "2020-07                    0  \n",
      "2020-08                    0  \n",
      "2020-09                    0  \n",
      "2020-10                    0  \n",
      "2020-11                    0  \n",
      "2020-12                    0  \n",
      "2021-01                    0  \n",
      "2021-02                    0  \n",
      "2021-03                    0  \n",
      "2021-04                    0  \n",
      "2021-05                    0  \n",
      "2021-06                    0  \n",
      "2021-07                    0  \n",
      "2021-08                    0  \n",
      "2021-09                    0  \n",
      "2021-10                    0  \n",
      "2021-11                    0  \n",
      "2021-12                    0  \n",
      "2022-01                    0  \n",
      "2022-02                    0  \n",
      "2022-03                    0  \n",
      "2022-04                    0  \n",
      "2022-05                    0  \n",
      "2022-06                    0  \n",
      "2022-07                    0  \n",
      "2022-08                    0  \n",
      "2022-09                    0  \n",
      "2022-10                    0  \n",
      "2022-11                    0  \n",
      "2022-12                    0  \n",
      "2023-01                    0  \n",
      "2023-02                    0  \n",
      "2023-03                    0  \n",
      "2023-04                    0  \n",
      "2023-05                    0  \n",
      "2023-06                    0  \n",
      "2023-07                    0  \n",
      "2023-08                    0  \n",
      "2023-09                    0  \n",
      "2023-10                    0  \n",
      "2023-11                    0  \n",
      "2023-12                    0  \n",
      "2024-01                   16  \n",
      "2024-02                    0  \n",
      "2024-03                    0  \n"
     ]
    }
   ],
   "source": [
    "#Use el mismo archivo anterior. Esta vez haga un reporte de fallecidos por mes, pero el tipo de muerte debe estar en columnas separadas.\n",
    "\n",
    "import pandas as pd\n",
    "\n",
    "# Cargamos el archivo CSV\n",
    "fallecidos_df = 'C:/Users/ESLEITER/Downloads/DATOS ESPACIALES/pc3/fallecidosCOVID.csv'\n",
    "covid_data = pd.read_csv(fallecidos_df, sep=';')\n",
    "# Convertimos la columna 'FECHA_FALLECIMIENTO' a formato de fecha\n",
    "covid_data['FECHA_FALLECIMIENTO'] = pd.to_datetime(covid_data['FECHA_FALLECIMIENTO'], format='%Y%m%d', errors='coerce')\n",
    "# Aseguramos que no haya espacios innecesarios\n",
    "covid_data['CLASIFICACION_DEF'] = covid_data['CLASIFICACION_DEF'].str.strip()\n",
    "# Agrupar por mes, tipo de muerte (CLASIFICACION_DEF) y contando los fallecidos\n",
    "month_death_type = covid_data.groupby([covid_data['FECHA_FALLECIMIENTO'].dt.to_period('M'), 'CLASIFICACION_DEF']).size().unstack(fill_value=0)\n",
    "\n",
    "# Mostrar el reporte de fallecidos por mes\n",
    "print(month_death_type)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
